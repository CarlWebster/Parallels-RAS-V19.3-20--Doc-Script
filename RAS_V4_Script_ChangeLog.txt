#webster@carlwebster.com
#@carlwebster on Twitter
#http://www.CarlWebster.com
#Created on February 9, 2018

#Version 1.0 was released to the community on 5-August-2020
#Work on 2.0 started on 20-Sep-2020
#Work on 3.0 started on 15-Nov-2022
#Work on 4.0 started on September 24, 2024

#Version 4.00 
#
#	Added new Functions:
#		OutputSiteSummary
#		OutputSiteDetails
#			OutputRDSessionHostsDetails
#			OutputVDIDetails
#			OutputRemotePCDetails
#			OutputProvidersDetails
#			OutputSecureGatewaysDetails
#			OutputConnectionBrokersDetails
#			OutputEnrollmentServersDetails
#			OutputHALBDetails
#			OutputThemesDetails
#			OutputCertificatesDetails
#			OutputApplicationPackagesDetails
#			OutputSettingsDetails
#	Clean up some console output
#	Fixed and refined the HTML, Text, and MSWord output
#	In Function OutputFarmSite, 
#		Add Farm Properties
#		For RAS V20 and later, add Access addresses
#	In Function OutputPoliciesDetails:
#		Update for the Policy changes in 19.3 and later
#		Handle multiple criteria
#		For RAS version 20.2 and later, added 
#			Session/Display/Published applications/Published applications/Enable Z-Order mode (Experimental)
#			Session/Printing/Default printer/Set the following printer as default
#			Session/Keyboard/Keyboard/Redirect remote keyboard input
#			Client options/Update/Client version management/Azure Virtual Desktop client
#			Client options/Advanced/Printing/Advanced client options - Printing settings/Dynamic printer redirection
#	In Function OutputRASLicense, update output to match the 19.4 console
#	In Function OutputRDSessionHostsDetails:
#		Changed Get-RASVDIHostStatus -Name $VDIPool.Name to Get-RASVDIHostStatus -InputObject $VDIPool.Id
#		Fixed bug in processing the variable $AppPackagesAssigned.ApplicationPackagesAssigned with the help of Guy Leech
#		For RDS Hosts details, rename "Agent settings" to "Settings, and move to after Desktop access
#		Add Application Packages
#		Only output optimization data if optimization is enabled
#		Add Auto-upgrade
#	In Function OutputSAMLSetting, handle multiple SAML items
#	In Function OutputSettingsDetails, add Azure Virtual Desktop to the Features section
#	In Function OutputSiteDetails, when processing Themes, Properties, Access:
#		If the Theme's MFA ID is not 0 and is found, use the MFA name
#		If the Theme's MFA ID is 0, use "No MFA provider selected for this Theme"
#		If the Theme's MFA ID is not found, use "Unable to determine MFA provider"
#	In Function OutputSiteSummary:
#		Added basic information for Tenant Brokers
#		Changed "VDI Host" to "Provider"
#	In Function OutputVDIDetails:
#		For Host pools properties, add:
#			Status
#			Template
#			Template version
#			ID
#	In Function ProcessScriptSetup, change how the RAS version is retrieved and put into variables
#	Updated for the PowerShell module changes in RAS 19.3 and later, and 20 and later
#	Updated numerous ENUMS throughout the script
